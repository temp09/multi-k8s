In this lab, you explored the default network along with its subnets, routes, and firewall rules. You deleted the default network and determined that you cannot create any VM instances without a VPC network. So, you went ahead and created a new auto mode VPC network with subnets, routes, firewall rules, and two VM instances. Then, you tested the connectivity for the VM instances, and exploit the effects of the firewall rules on connectivity. Let me walk you through the lab. Now, keep in mind that GCP's user's interface can change, so your environment might look slightly different. So, here I am in the GCP console. The first thing that I'm going to do is just take a look at the subnets. So, to do that, I'm going to click on the navigation menu, and I'm going to look for VPC networks, and then click on VPC networks. So, here we can see the default network, and you can see that there's a subnet for each of the different regions in which GCP has data centers. We can also see that each of these is in a private address space, that is the RFC 1918 CIDR block. I can also look at the routes by clicking over here, and these were automatically established. So, we can see a route to the default internet gateway, and then there's also a route for each of the individual subnets within the default network. Now, I can also view the Firewall rules. We're going over here, and these are all here by default. There is an Allow ICMP Firewall rule and Allow Internal Firewall rule. This will allows connections on all protocols and ports. There's a rule to RDP or remote desktop connection and one for SSH. Now, what I'm going to do is I'm going to delete this network. So, I'm going back to VPC networks. I'm going to click on Default, and I'm going to click Delete VPC network. I'm going to have to confirm that I want to delete that, and this is going to take a couple of seconds now, where you can see the progress right here, and anytime you're doing anything in the GCP Console, you'll see that you get notifications up here that tell you what's currently ongoing. So, you see that this operation is actually in process right now, and we'll get a notification when this has actually been completed. So, we can now see that the VPC network has been deleted, and I can click on the notification and see that that has just been completed. Now, we'll also see that if I go into the Routes section now, that there are no longer any routes because there's no network for those routes, and if I also go to the Firewall rules there are no firewall rules because those are attached to network. So, let's try and create a VM instance. If I go back to the navigation menu and scroll up, I'll find Compute Engine, and I can click on that. In here, I'm going to click Create now to create an instance. I can leave all of these defaults, but if I, down here, expand this Menu option management, security, disks, networking and sole tendency and click on the Networking tab, you see that actually get an error and it says there are no local networks available right now. Okay. So, as expected, I cannot create a VM instance without a VPC network. So, what we're going to do now is we're going to recreate that automatic created network that was in there, and that's pretty simple. I just go back to the VM instances page, and then scroll for VPC networks, and I'm going to create a VPC network. Now, I can give that network a name, so I can just call that "mynetwork", and then I have the option to choose between the Custom mode or the Automatic mode network. In this case, I'm going to choose the Automatic mode network. Again, what that means is that, a subnet will be created for each of the different regions as you can see right here. Now, I can also create some default firewall rules directly. These are the exact ones that we saw before. But, instead of being applied to the default network, they're now applied to this new network that I'm creating. So I can just directly select these, and you also see there is the imply to deny all egress. I'm sorry, deny all Ingress and the allow all egress rules to directly in here, too. So, I'm going to go ahead, and now and create this network. Again, there's an action now being performed in the console. So, I can see there's a progress, and if I go into Notifications, I can also see that I'm currently creating a network in here. So, now we can see that the mynetwork has been created, and just like before I have subnets for all of the individual regions. I could also go to Routes and see that I have all these routes, and to the firewall rules that I selected earlier are also visible just here. So, let's go ahead now and try to recreate a VM instance. So, for that I'm going ahead back to Compute Engine, and click on Create, and let me give this instance a name. So, this is in the network mynetwork, so I could use that as a name. I could specify this is in the US, and just say that specifically this is a VM. I can choose the region and zone, and I can modify the machine type. In this case, I'm fine with a micro, so I'm just going to click that. Now, I can go ahead and create that instance, so I can hide this info panel now. We can see that this VM has been created. Well, we can also see is the internal IP address. So, if we look at this, this is in the 10.128.0.2. I mentioned earlier that dot two would be the first address that is can be used, and we can also see if I click on nic0, that this is a part of the mynetwork network, and specifically it is in the zone that I specified, and it gets its IP address range from the subnet that is related to that zone. So, let me go ahead and create another VM instance, so I can just click on this plus icon right here, and let me create this one for example, in Europe. So, I'm going to say the name is mynet-eu-vm. I can specify the region as europe-west1, and you see directly that this is located in Belgium, and then I could choose a zone. Again, I don't need a very powerful machine, a micromachine, just a shared virtual CPU is more than enough, and then I, again, can click on Create. So, we can see that this VM is now being created, and again this internal IP address here the first usable addresses dot two and I can click on here to verify that it's a part of my network, and specifically it's the subnetwork that covers the Europe West 1 region. Now, the external IP addresses that are in here. They're actually both ephemeral. What that means is if I stop one of these instances and then restart it, you will actually assign a new address. I can change that if I want to, but I would have to assign a static external IP address and there's actually a cost associated to that. So, I'm not going to do that right now. Now, both of these instances are on the same network. So, ideally, I should be able to communicate between these instances. So, what I'm going to do now is I'm going to actually SSH into one of these instances, and I'm going to try to ping one of the other instances by using the external and internal IP addresses that I see right here. So, what I'm going to do is on the Machine in US Central 1, I'm going to click on SSH, and I'm just going to wait for that connection to be established, and then what I'm going to do is I'm going to grab the internal IP address of the other VM instance, and I'm going to try to ping this machine, and I'm going to just do that three times, and then paste the IP address. So, from here, we can see that all of the packets were transmitted. They're all received, zero packet loss, so I can communicate, and the reason I can do that is because these are both on the same network, and there's the default allow all internal firewall rule that I checked earlier. Now, let me repeat the same, but this time I actually use the name of the instance. So, I'm going to ping again three times. I'm going to use the name of the VM, mynet-eu-vm, and this works as well. We can actually see that the fully qualified domain name here is actually what was ultimately reached, and this is very useful especially if I restart instances even the internal IP address is actually ephemeral, and with the fully qualified domain name, I can make sure that I can always reach this VM instance. Now, I can also get to the external IP address. So, let me grab the external IP address now, and come back, and instead of pinging the internal IP address, I'm going to ping that, and that works as well because of the allow ICMP firewall rule that we have. So, currently, I can ping internally as well as externally between these VM instances. Now, let me see if that's still the case if I've removed some of the firewall rules. So, I'm going to go back to VPC networks, Firewall rules, and I'm going to select the ICMP rule, and I'm going to ask to delete that. Yes, I'm confirming. So, now that the rule has been deleted, let me go back to my VM instance. Just still have open here, and to try to ping the external IP address one more time. So, we can see that this is not really working. It's currently failing. I'm actually going to wait for it to timeout, and there we go. So, we made that the zero of the packets were received, meaning all of them were last. I'm going to use my recall buffer in here to just ping the internal IP address one more time. When we can see that that's still works, because I have that firewall rule that allows connections within my network, just not across the network anymore. There are, similarly, I want to show the effect of deleting that firewall rule. So, I'm going to go back, click on the allow internal rule, and delete that as well. All right. So, now that that rule is deleted as well, let me go back to that instance and try to ping the internal IP address one more time, and as expected, we are no longer able to do that now. You can see that this is kind of hanging here, but it's going to give us an error in just a second and say that all the packets were lost, and there we go. So, let me exit out of this instance. Now, the last rule that we're going to delete is the SSH rule. Now, I'm using Linux-based instances, so I'm using SSH. If you were using a Windows-based instance, you probably would want to delete the RTP instead. So, let me delete this firewall rule, and now I'm going to go back to Compute Engine, and just click on SSH for any of these instances. It's going to pop up a window for me, and it's going to try that now a couple of times. It's already a lot slower than we saw earlier, and it's going to give us several tries, and ultimately, we should be getting an error that it just can't connect to that specific port. So, let's just wait for that to come up. All right. So, we can see that the connection has failed, we're unable to connect to the VM on port 22. So, with that, we've successfully shown that these firewall rules do affect the VM instances, and that you have full control over the access to those instances.