Let me work through an HTTP
load balancer in action. The project on this slide has
single global IP address, but users enter the
Google Cloud network from two different locations, one in North America, and one in EMEA. First, the global
forwarding rule directs incoming requests to
the target HTTP proxy. The proxy checks the URL map to determine the
appropriate back-end service for the request. In this case, we're serving a guestbook application with
only one back-end service. The back-end service
has two back-ends, one in US Central 1-a, and one in Europe West 1-d. Each of those back-ends consist of a managed instance group. Now, when a user
request comes in, the load balancing
service determines the approximate origin of the request from the
source IP address. The load balancing
service also knows the locations of the instances owned by the back-end service, their overall capacity and
their overall current usage. Therefore, if the
instances closest to the user has
available capacity, the request is forwarded to that closest set of instances. In our example, traffic from
the user in North America, would be forwarded to the managed instance
group in US Central 1-a, and the traffic from the
user in EMEA would be forwarded to the
managed instance group in Europe West 1-d. If there are several
users in each region, the incoming requests
to the given region are distributed evenly across all available back-end services, and instances in that region. If there are no
healthy instances, with available capacity
in a given region, the load balancer instead
sends the request to the next closest region
with available capacity. Therefore, traffic
from the EMEA user, could be forwarded to the
US Central 1-a back-end, if the Europe West 1-d back-end
does not have capacity, or has no healthy instances as determined by
the health checker. This is referred to as
cross-region load balancing. Another example, of an
HTTPS load balancer, is a content-based load balancer. In this case there are two separate back-end
services that handle either web
or video traffic. The traffic is split by
the load balancer based on the URL header as
specified in the URL map, if the user's navigating
to slash video, the traffic is sent to the back-end video service and if the user is navigating
anywhere else, the traffic is sent to
the web service back-end. All of that is achieved with
a single global IP address.